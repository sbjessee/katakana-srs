<div class="dashboard-container">
  <h1>Dashboard</h1>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading">
    <div class="spinner"></div>
    <p>Loading dashboard...</p>
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!isLoading && stats" class="dashboard-content">
    <!-- Lessons Available Section -->
    <div class="hero-section lessons" *ngIf="stats.lessons_available > 0">
      <h2>{{ stats.lessons_available }} Lessons Available!</h2>
      <p>Learn new katakana characters</p>
      <a routerLink="/lessons" class="btn btn-lg btn-primary">Start Lesson</a>
    </div>

    <!-- Reviews Available Section -->
    <div class="hero-section" *ngIf="stats.reviews_due_now > 0 && stats.lessons_available === 0">
      <h2>{{ stats.reviews_due_now }} Reviews Available!</h2>
      <a routerLink="/review" class="btn btn-lg btn-primary">Start Reviews</a>
    </div>

    <div class="hero-section no-reviews" *ngIf="stats.reviews_due_now === 0 && stats.lessons_available === 0">
      <h2>All Caught Up!</h2>
      <p>No lessons or reviews due right now. Great work!</p>
      <a routerLink="/katakana" class="btn btn-secondary">View All Katakana</a>
    </div>

    <!-- Secondary Action (if lessons available but also showing reviews) -->
    <div class="secondary-action" *ngIf="stats.reviews_due_now > 0 && stats.lessons_available > 0">
      <p>You also have {{ stats.reviews_due_now }} reviews available</p>
      <a routerLink="/review" class="btn btn-secondary">Start Reviews</a>
    </div>

    <!-- Stats Grid -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-value">{{ stats.total_items }}</div>
        <div class="stat-label">Total Items</div>
      </div>

      <div class="stat-card">
        <div class="stat-value">{{ stats.reviews_due_today }}</div>
        <div class="stat-label">Due Today</div>
      </div>

      <div class="stat-card">
        <div class="stat-value">{{ stats.accuracy_rate }}%</div>
        <div class="stat-label">Accuracy</div>
      </div>
    </div>

    <!-- SRS Stage Distribution -->
    <div class="section">
      <h3>SRS Stage Distribution</h3>
      <div class="stage-distribution">
        <div *ngFor="let stage of getStageEntries()" class="stage-item">
          <div class="stage-bar">
            <div
              class="stage-fill"
              [style.width.%]="(stage.count / stats.total_items) * 100"
              [style.background-color]="stage.color"
            ></div>
          </div>
          <div class="stage-info">
            <span class="stage-name" [style.color]="stage.color">{{ stage.name }}</span>
            <span class="stage-count">{{ stage.count }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Upcoming Reviews -->
    <div class="section" *ngIf="upcomingReviews.length > 0">
      <h3>Upcoming Reviews (Next 7 Days)</h3>
      <div class="upcoming-list">
        <div *ngFor="let upcoming of upcomingReviews" class="upcoming-item">
          <span class="upcoming-date">{{ formatDate(upcoming.date) }}</span>
          <span class="upcoming-count">{{ upcoming.count }} reviews</span>
        </div>
      </div>
    </div>
  </div>
</div>
